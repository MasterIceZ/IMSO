#ifndef _CP_NETWORK_MARKETING_INCLUDED_
#define _CP_NETWORK_MARKETING_INCLUDED_

// you can include anything here

#include <map>

namespace CP {

template <typename T>
class network_marketing {
	// your code here
private:
  std::map<T, T> parent_map;
  std::map<T, size_t> sz;

public:
  void setparent(T child, T parent) {
    auto it = parent_map.find(child);
    if (it != parent_map.end()) {
      T old_p = it->second;
      T current = old_p;
      size_t delta = sz[child] + 1;
      while (true) {
        sz[current] -= delta;
        auto pit = parent_map.find(current);
        if (pit == parent_map.end()) break;
        current = pit->second;
      }
    }
    parent_map[child] = parent;
    T current = parent;
    size_t delta = sz[child] + 1;
    while (true) {
      sz[current] += delta;
      auto pit = parent_map.find(current);
      if (pit == parent_map.end()) break;
      current = pit->second;
    }
  }

  size_t count_children(T x) {
    return sz[x];
  }
};

}
#endif

/*                                                                               
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣠⡤⠤⣤⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⠴⠟⠋⠀⠀⠀⠀⠈⠙⠳⣦⡀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⠞⠁⠀⠀⠀⢀⣀⣀⣤⡴⢂⣀⠀⠻⡆⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⠏⣀⣤⣴⡿⣋⣤⣍⠥⠾⠟⠛⠃⠀⠀⣷⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⣀⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⠀⠈⠉⠉⠉⠀⠀⠀⠀⠐⠚⠛⠙⠀⠀⣿⡀⠀⠀⠀
⠀⠀⠀⣀⡴⠞⠋⠉⠀⠉⠙⠓⠦⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⡄⠠⠶⠟⣛⣓⣀⢀⣰⣿⣶⣶⠀⠀⠀⢻⡇⠀⠀⠀
⠀⣠⡾⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠙⢶⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⣧⠀⠰⣿⡿⡿⡇⢸⠉⠉⠉⠀⠀⠀⠀⢸⡇⠀⠀⠀
⠾⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⢦⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣶⣦⣀⡀⠀⠀⠀⠀⢻⡆⠀⠀⠀⢀⡇⠈⢷⡄⠀⠀⠀⠀⠀⢸⡇⠀⠀⠀
⠀⠒⢲⣶⣶⣶⣶⣒⡲⠶⠦⠤⠤⣤⢤⠄⣀⠀⢳⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⣷⠈⠉⠓⠒⠶⢤⣬⣿⠀⠀⠀⠸⣧⡤⠴⠇⠀⠀⠀⠀⣠⣿⡇⠀⠀⠀
⢀⡾⠟⣛⡉⠙⠓⠻⠟⠉⢉⣽⠿⠻⠯⢵⣦⠉⠀⢻⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣦⣄⠀⠀⠀⠀⠀⠙⣶⡀⠀⣠⣰⣖⣒⡦⣄⡀⠀⣸⣿⣿⠍⠀⠠⣤
⠈⠀⠉⠉⠉⢷⣤⡀⠀⠀⠀⠀⠀⣠⠴⠒⢮⣄⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠳⣄⠀⠀⠀⠀⠈⢷⣼⣿⣿⣿⣿⣷⡌⢹⣶⣿⣿⠛⠀⠀⠀⠀
⠛⠛⣟⣿⣿⢿⠶⠦⣤⠄⢲⣤⠤⢬⡤⡤⠤⠤⣤⣤⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⢆⠀⠀⠀⠀⠻⣇⠙⠛⡛⠁⠀⢈⣴⡿⠃⠀⠀⠀⠀⠀
⠀⠀⡻⠿⣿⣶⡄⠀⣼⡖⢾⣧⢠⣿⣷⣦⠆⠀⠀⣿⣿⠆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠳⣄⠀⠀⠀⠘⠿⣦⣄⣀⣠⣾⠋⠀⠀⠀⠀⠀⠀⠀
⣤⣀⣛⣳⣶⣿⣣⡾⡟⠀⠀⢿⣿⣿⣱⣷⣾⣂⣼⠿⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢳⡄⠀⠀⠀⠈⠋⠀⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠉⠉⠉⠉⠉⠉⠀⢀⡇⠀⠀⠘⡇⠉⠉⠉⠉⠁⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢳⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⢾⡁⠀⠀⢀⡇⠀⠀⠀⠀⠀⠀⢠⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⣆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⢠⡍⠙⠋⠁⠀⠀⠀⠀⠀⠀⠀⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢹⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⢀⡶⠛⣹⣯⠰⣿⣆⠀⠀⠀⠀⢀⣼⡟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⣧⠀⠀⠀⠀⣿⣇⣽⣿⣿⣦⣭⡟⣧⠀⠀⢰⡦⡿⠇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⣿⠆⠀⠀⢀⣿⣿⣿⣿⣿⣿⡏⡟⠓⡄⣶⣿⣿⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⣥⠈⣶⡆⣼⣿⣾⡎⠿⠿⠟⠁⡇⢸⡿⢿⣿⡿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⢿⣿⣿⣷⡇⣾⢿⡗⠶⠴⠆⠈⢠⠞⣳⣿⣿⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠂⠙⣿⣯⣷⣿⠸⣿⠀⠀⣤⠀⣈⣴⠟⠂⣻⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠈⡿⣿⣀⡙⡅⠀⢰⣧⣿⡏⠀⢠⢿⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⡟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀                            
*/